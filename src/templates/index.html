<!DOCTYPE html>
<!--
	**************************************************************
	AICloud - AITalk WebAPI - 呼び出しサンプル JavaScript版

	★利用の際は、AITalkWebAPIクラス内にあるID, PWの値を
	　利用アカウントのID/PWに書き換えてください。
	★Webサーバー, JavaScript環境の構築を事前に行ってください。
	★次の環境で動作を確認しています。
	　サーバー: Windows7 64bit, Apache 2.4
	　クライアント: Windows7 64bit, Chrome Ver.64.0 / Firefox Ver.58.0
	★呼び出し方
	　Webサーバーに配備し、ブラウザからアクセスしてください。
	★処理内容
	　- WebAPIに文字列を投げて合成
	　- 合成に失敗した場合はエラーメッセージを表示
	　- 合成に成功した場合は再生プレイヤーから自動再生

	本サンプルコードは、
	AITalk WebAPIの呼び出し確認のためのサンプルプログラムです。
	本サンプルコードの利用により、万一お客様に損害が生じたとしても、
	当社はその損害について一切の責任を負いません。
	本サンプルコードに不備があった場合でも、
	当社は修正およびサポートの義務を負わないものとします。

	Copyright (c) 2018 AI, Inc. (https://ai-j.jp/)
	**************************************************************
-->
<html>
<head>
    <meta charset="UTF-8">
    <title>AITalk WebAPI Sample (JavaScript)</title>
    <link rel="stylesheet" href="/css/recommendation_list.css" type="text/css">
    <script src="/js/AITalkWebAPI.js" type="text/javascript" charset="utf-8"></script>
    <script src="/js/jquery-1.10.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script>
        $(function () {
            $('.read').click(function (event) {
                var description = $(this).closest('[read-description-td]').find("input[type='hidden']").val();
                var aitalk = new AITalkWebAPI();
                aitalk.speakOutMessage('miyabi_west', description);
            });
        });
    </script>
</head>
<body>
    <main>
        <article class="akane_image_box">
            <!--<div id="status">読み込み中です。</div>-->
            <audio class="display-off" id="audio" controls autoplay></audio>
            <img src="" alt="akane" class="akane_image" id="akane_image">

        </article>
        <aside class="recommendation_list">
            <table class="recommendation_list_table">

                    あなたの入力 <br>
                    {{result.input.totalLike}}/{{result.input.totalJoy}}/{{result.input.totalAnger}}
                
                    <tbody>
                        <tr>
                            <th>題名</th>
                            <th>著者</th>
                            <th>Like/Anger/Fear</th>
                            <th>紹介/あらすじ</th>
                        </tr>
                    {% for book in result.books %}
                        <tr>
                            <td>{{book.optionalInfo.title}}</td>
                            <td>{{book.optionalInfo.author}}</td>
                            <th>{{book.result.totalLike}}/{{book.result.totalJoy}}/{{book.result.totalAnger}}</th>
                            <td read-description-td>
                                <input type="hidden" value="{{book.optionalInfo.description}}" id="{{book.id}}" read-description-hidden />
                                <a class="read" href="javascript:void(0);">
                                    読む
                                </a>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
        </aside>
    </main>

    <script>
        function displayRandomMiyabi() {
            var $akane_image = $('#akane_image');

            var min = 1;
            var max = 4;
            var random_number = Math.floor(Math.random() * (max + 1 - min)) + min;
            var image_path = '/images/akane/akane$$$.png';
            image_path = image_path.replace('$$$', random_number);
            $akane_image.attr('src', image_path);
        }

        $(window).on('load', function() {
            // TODO: 後でデフォルトの音声をここで再生する
            displayRandomMiyabi();
        });
        
    </script>
</body>
</html>
